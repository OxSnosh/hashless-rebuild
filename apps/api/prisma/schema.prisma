datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

generator client {
  provider = "prisma-client-js"
}

model Contract {
  id         String         @id @default(cuid())
  address    String
  chain      String
  createdAt  DateTime       @default(now())
  txs        Transaction[]

  @@unique([chain, address], name: "chain_address_unique")
}

model Transaction {
  id           String   @id @default(cuid())
  hash         String
  chain        String  
  blockNumber  Int
  timestamp    DateTime
  fromAddress  String
  toAddress    String?
  valueWei     String?

  contractId   String?
  contract     Contract? @relation(fields: [contractId], references: [id], onDelete: SetNull)

  @@unique([chain, hash], name: "chain_hash_unique")
  @@index([blockNumber, chain])
  @@index([contractId])
}